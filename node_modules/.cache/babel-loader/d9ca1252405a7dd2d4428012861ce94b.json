{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\project\\\\app-apd\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import PolicyView from\"../Forms/PolicyDetailView\";import CustomerView from\"../Forms/CustomerDetailView\";import Sidebar from\"../../Components/Sidebar\";import Navuser from\"../../Components/Navbar\";import Footer from\"../../Components/Footer/footer.js\";import Loader from\"../../Components/Loader\";import{Tab,Row,Col,Container,Image}from\"react-bootstrap\";import axios from\"axios\";import Menu from\"../../../src/assets/images/simedis/Icon-menu.svg\";import\"./index.scss\";var Dashboard=/*#__PURE__*/function(_Component){_inherits(Dashboard,_Component);var _super=_createSuper(Dashboard);function Dashboard(props){var _this;_classCallCheck(this,Dashboard);_this=_super.call(this,props);_this.state={width:window.innerWidth,toggle:false};_this.handleMenuClick=_this.handleMenuClick.bind(_assertThisInitialized(_this));_this.handleLogout=_this.handleLogout.bind(_assertThisInitialized(_this));return _this;}_createClass(Dashboard,[{key:\"componentDidMount\",value:function componentDidMount(){console.log(this.props);var updateAccountData=this.props.simedisAccountChange;var updatePolicies=this.props.updatePolicies;var updateRegistrationType=this.props.updateRegistrationType;var updateformOne=this.props.formOne;var loadHandler=this.props.updatePageLoad;loadHandler(true);this.processData(updateAccountData,loadHandler,updatePolicies,updateRegistrationType,updateformOne);this.updateDimensions();window.addEventListener(\"resize\",this.updateDimensions.bind(this));}},{key:\"updateDimensions\",value:function updateDimensions(){this.setState({width:window.innerWidth});}},{key:\"processData\",value:function(){var _processData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(updateAccountData,loadHandler,updatePolicies,updateRegistrationType,updateformOne){var res1,res2,res3,res4;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.getCustomerPolicy(updateAccountData,loadHandler,updatePolicies,updateRegistrationType);case 2:res1=_context.sent;_context.next=5;return this.getCertificate(updateAccountData,loadHandler);case 5:res2=_context.sent;_context.next=8;return this.getCustomerDetail(loadHandler,updateformOne,updateAccountData);case 8:res3=_context.sent;_context.next=11;return this.getAccountPoint(updateAccountData,loadHandler);case 11:res4=_context.sent;if(res1!==true&&res2!==true&&res3!==true&&res4!==true){this.failCase(updateAccountData,loadHandler);}return _context.abrupt(\"return\",true);case 14:case\"end\":return _context.stop();}}},_callee,this);}));function processData(_x,_x2,_x3,_x4,_x5){return _processData.apply(this,arguments);}return processData;}()},{key:\"getCustomerPolicy\",value:function(){var _getCustomerPolicy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(updateAccountData,loadHandler,updatePolicies,updateRegistrationType){var accountData,url,data,config,res,customerPolicy,registrationType;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:accountData=this.props.states.simedis_account;_context2.prev=1;url=\"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/policy\";data={emailAddress:accountData.username// emailAddress: \"revanza-27@yopmail.com\",\n};config={headers:{Authorization:accountData.token}};_context2.next=7;return axios.post(url,data,config);case 7:res=_context2.sent;console.log(res);if(!res.data.ok){this.failCase(updateAccountData,loadHandler);}customerPolicy=res.data.data.customerPolicy;registrationType=res.data.data.registrationType;updateAccountData(\"customer_code\",customerPolicy.customerCode);updatePolicies(customerPolicy);updateRegistrationType(registrationType);return _context2.abrupt(\"return\",true);case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 21:case\"end\":return _context2.stop();}}},_callee2,this,[[1,18]]);}));function getCustomerPolicy(_x6,_x7,_x8,_x9){return _getCustomerPolicy.apply(this,arguments);}return getCustomerPolicy;}()},{key:\"getCertificate\",value:function(){var _getCertificate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(updateAccountData,loadHandler){var accountData,url,data,config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;accountData=this.props.states.simedis_account;url=\"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/get-certificate\";data={customerCode:accountData.customer_code};config={headers:{Authorization:accountData.token}};_context3.next=7;return axios.post(url,data,config);case 7:res=_context3.sent;console.log(res);if(!res.data.ok){this.failCase(updateAccountData,loadHandler);}updateAccountData(\"base64\",res.data.data.data.certificate);return _context3.abrupt(\"return\",true);case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 17:case\"end\":return _context3.stop();}}},_callee3,this,[[0,14]]);}));function getCertificate(_x10,_x11){return _getCertificate.apply(this,arguments);}return getCertificate;}()},{key:\"getCustomerDetail\",value:function(){var _getCustomerDetail=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(loadHandler,updateformOne,updateAccountData){var accountData,url,config,res,dataCustomer;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;accountData=this.props.states.simedis_account;url=\"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/customers/\"+accountData.customer_code;config={headers:{Authorization:accountData.token}};_context4.next=6;return axios.get(url,config);case 6:res=_context4.sent;if(!res.data.ok){this.failCase(updateAccountData,loadHandler);}console.log(res);_context4.next=11;return res.data.data;case 11:dataCustomer=_context4.sent;updateformOne(\"first_name\",dataCustomer.customerName);updateformOne(\"birth_date\",dataCustomer.dateOfBirth);updateformOne(\"gender\",dataCustomer.genderCode);updateformOne(\"email\",dataCustomer.emailAddress);updateformOne(\"phone_number\",dataCustomer.phoneNo);loadHandler(false);return _context4.abrupt(\"return\",true);case 21:_context4.prev=21;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);return _context4.abrupt(\"return\",false);case 25:case\"end\":return _context4.stop();}}},_callee4,this,[[0,21]]);}));function getCustomerDetail(_x12,_x13,_x14){return _getCustomerDetail.apply(this,arguments);}return getCustomerDetail;}()},{key:\"getAccountPoint\",value:function(){var _getAccountPoint=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(updateAccountData,loadHandler){var accountData,data,url,config,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;accountData=this.props.states.simedis_account;data={emailAddress:accountData.username// emailAddress: \"revanza-27@yopmail.com\",\n};url=\"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/account-point\";config={headers:{Authorization:accountData.token}};_context5.next=7;return axios.post(url,data,config);case 7:res=_context5.sent;console.log(res);if(!res.data.ok){this.failCase(updateAccountData,loadHandler);}_context5.next=16;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](0);console.log(_context5.t0);return _context5.abrupt(\"return\",false);case 16:case\"end\":return _context5.stop();}}},_callee5,this,[[0,12]]);}));function getAccountPoint(_x15,_x16){return _getAccountPoint.apply(this,arguments);}return getAccountPoint;}()},{key:\"failCase\",value:function failCase(updateAccountData,loadHandler){loadHandler(false);updateAccountData(\"is_valid\",false);updateAccountData(\"form_status\",\"Mohon maaf koneksi mengalami kendala, silahkan coba lagi\");this.props.history.push(\"/login\");}},{key:\"handleMenuClick\",value:function handleMenuClick(){this.setState({toggle:!this.state.toggle});}},{key:\"handleLogout\",value:function handleLogout(){this.props.history.push(\"/login\");}},{key:\"render\",value:function render(){var _this2=this;var states=this.props.states;console.log(states);if(!states||states.is_loading===true){return/*#__PURE__*/React.createElement(\"div\",{className:\"main-dashboard-loading\"},/*#__PURE__*/React.createElement(Container,{className:\"dashboard-loading-container-0\",fluid:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Loader,null))));}var toggled;var mobileMenu;if(this.state.width<=\"992\"){mobileMenu=/*#__PURE__*/React.createElement(Container,{className:\"dash-burger-menu\"},/*#__PURE__*/React.createElement(\"a\",{onClick:function onClick(e){return _this2.handleMenuClick();}},/*#__PURE__*/React.createElement(Image,{src:Menu})));if(this.state.toggle){toggled=\"toggled\";}else{toggled=\"not-toggled\";}}else{mobileMenu=null;}return/*#__PURE__*/React.createElement(\"div\",{className:\"main-dashboard\"},/*#__PURE__*/React.createElement(Tab.Container,{defaultActiveKey:\"policy\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Sidebar,{data:states.form_1,width:this.state.width,toggled:toggled,handleExitSidebar:this.handleMenuClick,handleLogout:this.handleLogout}),/*#__PURE__*/React.createElement(Col,{className:\"dashboard-content \".concat(toggled)},/*#__PURE__*/React.createElement(Navuser,{data:states.form_1}),mobileMenu,/*#__PURE__*/React.createElement(Tab.Content,{className:\"dashboard-tab-content\"},/*#__PURE__*/React.createElement(Tab.Pane,{className:\"dashboard-tab-pane\",eventKey:\"profile\"},/*#__PURE__*/React.createElement(CustomerView,{data:states.form_1})),/*#__PURE__*/React.createElement(Tab.Pane,{className:\"dashboard-tab-pane\",eventKey:\"policy\"},/*#__PURE__*/React.createElement(PolicyView,{data:states.policies,reg:states.registration_type,certificate:states.simedis_account.base64}))),/*#__PURE__*/React.createElement(Footer,null)))));}}]);return Dashboard;}(Component);export default Dashboard;","map":{"version":3,"sources":["D:/project/app-apd/src/Pages/Dashboard/index.js"],"names":["React","Component","PolicyView","CustomerView","Sidebar","Navuser","Footer","Loader","Tab","Row","Col","Container","Image","axios","Dashboard","props","state","width","window","innerWidth","toggle","handleMenuClick","bind","handleLogout","console","log","updateAccountData","simedisAccountChange","updatePolicies","updateRegistrationType","updateformOne","formOne","loadHandler","updatePageLoad","processData","updateDimensions","addEventListener","setState","getCustomerPolicy","res1","getCertificate","res2","getCustomerDetail","res3","getAccountPoint","res4","failCase","accountData","states","simedis_account","url","data","emailAddress","username","config","headers","Authorization","token","post","res","ok","customerPolicy","registrationType","customerCode","customer_code","certificate","get","dataCustomer","customerName","dateOfBirth","genderCode","phoneNo","history","push","is_loading","toggled","mobileMenu","e","Menu","form_1","policies","registration_type","base64"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PolicyView from \"../Forms/PolicyDetailView\";\r\nimport CustomerView from \"../Forms/CustomerDetailView\";\r\nimport Sidebar from \"../../Components/Sidebar\";\r\nimport Navuser from \"../../Components/Navbar\";\r\nimport Footer from \"../../Components/Footer/footer.js\";\r\nimport Loader from \"../../Components/Loader\";\r\nimport { Tab, Row, Col, Container, Image } from \"react-bootstrap\";\r\nimport axios from \"axios\";\r\nimport Menu from \"../../../src/assets/images/simedis/Icon-menu.svg\";\r\n\r\nimport \"./index.scss\";\r\n\r\nclass Dashboard extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      width: window.innerWidth,\r\n      toggle: false,\r\n    };\r\n\r\n    this.handleMenuClick = this.handleMenuClick.bind(this);\r\n    this.handleLogout = this.handleLogout.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log(this.props);\r\n    const updateAccountData = this.props.simedisAccountChange;\r\n    const updatePolicies = this.props.updatePolicies;\r\n    const updateRegistrationType = this.props.updateRegistrationType;\r\n    const updateformOne = this.props.formOne;\r\n    const loadHandler = this.props.updatePageLoad;\r\n\r\n    loadHandler(true);\r\n\r\n    this.processData(\r\n      updateAccountData,\r\n      loadHandler,\r\n      updatePolicies,\r\n      updateRegistrationType,\r\n      updateformOne\r\n    );\r\n\r\n    this.updateDimensions();\r\n    window.addEventListener(\"resize\", this.updateDimensions.bind(this));\r\n  }\r\n\r\n  updateDimensions() {\r\n    this.setState({ width: window.innerWidth });\r\n  }\r\n\r\n  async processData(\r\n    updateAccountData,\r\n    loadHandler,\r\n    updatePolicies,\r\n    updateRegistrationType,\r\n    updateformOne\r\n  ) {\r\n    const res1 = await this.getCustomerPolicy(\r\n      updateAccountData,\r\n      loadHandler,\r\n      updatePolicies,\r\n      updateRegistrationType\r\n    );\r\n\r\n    const res2 = await this.getCertificate(updateAccountData, loadHandler);\r\n\r\n    const res3 = await this.getCustomerDetail(\r\n      loadHandler,\r\n      updateformOne,\r\n      updateAccountData\r\n    );\r\n\r\n    const res4 = await this.getAccountPoint(updateAccountData, loadHandler);\r\n\r\n    if (res1 !== true && res2 !== true && res3 !== true && res4 !== true) {\r\n      this.failCase(updateAccountData, loadHandler);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  async getCustomerPolicy(\r\n    updateAccountData,\r\n    loadHandler,\r\n    updatePolicies,\r\n    updateRegistrationType\r\n  ) {\r\n    const accountData = this.props.states.simedis_account;\r\n    try {\r\n      const url =\r\n        \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/policy\";\r\n      const data = {\r\n        emailAddress: accountData.username,\r\n        // emailAddress: \"revanza-27@yopmail.com\",\r\n      };\r\n      const config = {\r\n        headers: {\r\n          Authorization: accountData.token,\r\n        },\r\n      };\r\n\r\n      const res = await axios.post(url, data, config);\r\n      console.log(res);\r\n      if (!res.data.ok) {\r\n        this.failCase(updateAccountData, loadHandler);\r\n      }\r\n      const customerPolicy = res.data.data.customerPolicy;\r\n      const registrationType = res.data.data.registrationType;\r\n\r\n      updateAccountData(\"customer_code\", customerPolicy.customerCode);\r\n      updatePolicies(customerPolicy);\r\n      updateRegistrationType(registrationType);\r\n\r\n      return true;\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  async getCertificate(updateAccountData, loadHandler) {\r\n    try {\r\n      const accountData = this.props.states.simedis_account;\r\n      const url =\r\n        \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/get-certificate\";\r\n      const data = {\r\n        customerCode: accountData.customer_code,\r\n      };\r\n      const config = {\r\n        headers: {\r\n          Authorization: accountData.token,\r\n        },\r\n      };\r\n      const res = await axios.post(url, data, config);\r\n      console.log(res);\r\n      if (!res.data.ok) {\r\n        this.failCase(updateAccountData, loadHandler);\r\n      }\r\n      updateAccountData(\"base64\", res.data.data.data.certificate);\r\n      return true;\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  async getCustomerDetail(loadHandler, updateformOne, updateAccountData) {\r\n    try {\r\n      const accountData = this.props.states.simedis_account;\r\n      const url =\r\n        \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/customers/\" +\r\n        accountData.customer_code;\r\n\r\n      const config = {\r\n        headers: {\r\n          Authorization: accountData.token,\r\n        },\r\n      };\r\n\r\n      const res = await axios.get(url, config);\r\n      if (!res.data.ok) {\r\n        this.failCase(updateAccountData, loadHandler);\r\n      }\r\n      console.log(res);\r\n      const dataCustomer = await res.data.data;\r\n      updateformOne(\"first_name\", dataCustomer.customerName);\r\n      updateformOne(\"birth_date\", dataCustomer.dateOfBirth);\r\n      updateformOne(\"gender\", dataCustomer.genderCode);\r\n      updateformOne(\"email\", dataCustomer.emailAddress);\r\n      updateformOne(\"phone_number\", dataCustomer.phoneNo);\r\n      loadHandler(false);\r\n      return true;\r\n    } catch (err) {\r\n      console.log(err);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async getAccountPoint(updateAccountData, loadHandler) {\r\n    try {\r\n      const accountData = this.props.states.simedis_account;\r\n      const data = {\r\n        emailAddress: accountData.username,\r\n        // emailAddress: \"revanza-27@yopmail.com\",\r\n      };\r\n      const url =\r\n        \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/account-point\";\r\n\r\n      const config = {\r\n        headers: {\r\n          Authorization: accountData.token,\r\n        },\r\n      };\r\n\r\n      const res = await axios.post(url, data, config);\r\n\r\n      console.log(res);\r\n      if (!res.data.ok) {\r\n        this.failCase(updateAccountData, loadHandler);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  failCase(updateAccountData, loadHandler) {\r\n    loadHandler(false);\r\n    updateAccountData(\"is_valid\", false);\r\n    updateAccountData(\r\n      \"form_status\",\r\n      \"Mohon maaf koneksi mengalami kendala, silahkan coba lagi\"\r\n    );\r\n\r\n    this.props.history.push(\"/login\");\r\n  }\r\n\r\n  handleMenuClick() {\r\n    this.setState({ toggle: !this.state.toggle });\r\n  }\r\n\r\n  handleLogout() {\r\n    this.props.history.push(\"/login\");\r\n  }\r\n\r\n  render() {\r\n    const { states } = this.props;\r\n\r\n    console.log(states);\r\n\r\n    if (!states || states.is_loading === true) {\r\n      return (\r\n        <div className=\"main-dashboard-loading\">\r\n          <Container className=\"dashboard-loading-container-0\" fluid>\r\n            <Row>\r\n              <Loader />\r\n            </Row>\r\n          </Container>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    let toggled;\r\n    let mobileMenu;\r\n    if (this.state.width <= \"992\") {\r\n      mobileMenu = (\r\n        <Container className=\"dash-burger-menu\">\r\n          <a onClick={(e) => this.handleMenuClick()}>\r\n            <Image src={Menu} />\r\n          </a>\r\n        </Container>\r\n      );\r\n\r\n      if (this.state.toggle) {\r\n        toggled = \"toggled\";\r\n      } else {\r\n        toggled = \"not-toggled\";\r\n      }\r\n    } else {\r\n      mobileMenu = null;\r\n    }\r\n\r\n    return (\r\n      <div className=\"main-dashboard\">\r\n        <Tab.Container defaultActiveKey=\"policy\">\r\n          <Row>\r\n            <Sidebar\r\n              data={states.form_1}\r\n              width={this.state.width}\r\n              toggled={toggled}\r\n              handleExitSidebar={this.handleMenuClick}\r\n              handleLogout={this.handleLogout}\r\n            />\r\n            <Col className={`dashboard-content ${toggled}`}>\r\n              <Navuser data={states.form_1} />\r\n              {mobileMenu}\r\n              <Tab.Content className=\"dashboard-tab-content\">\r\n                <Tab.Pane className=\"dashboard-tab-pane\" eventKey=\"profile\">\r\n                  <CustomerView data={states.form_1} />\r\n                </Tab.Pane>\r\n                <Tab.Pane className=\"dashboard-tab-pane\" eventKey=\"policy\">\r\n                  <PolicyView\r\n                    data={states.policies}\r\n                    reg={states.registration_type}\r\n                    certificate={states.simedis_account.base64}\r\n                  />\r\n                </Tab.Pane>\r\n              </Tab.Content>\r\n              <Footer />\r\n            </Col>\r\n          </Row>\r\n        </Tab.Container>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}