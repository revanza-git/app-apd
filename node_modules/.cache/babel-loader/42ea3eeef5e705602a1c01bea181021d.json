{"ast":null,"code":"var _jsxFileName = \"D:\\\\project\\\\app-apd\\\\src\\\\Pages\\\\Finished\\\\index.js\";\nimport React, { Component } from \"react\";\nimport qs from \"qs\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport Loader from \"react-loader-spinner\";\nimport Alerts from \"../../Components/Alerts\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport { Card, Button, Row, Container, Col, Form } from \"react-bootstrap\";\n\nclass FinishedPayment extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.copyCodeToClipboard = text => {\n      console.log(text);\n      const el = text;\n      el.select();\n      document.execCommand(\"copy\");\n    };\n  }\n\n  componentDidMount() {\n    const data = this.props.states.midtrans_account;\n    const updateHandler = this.props.simedisChange; //parsing URL\n\n    const query = qs.parse(this.props.location.search, {\n      ignoreQueryPrefix: true\n    });\n    const loadHandler = this.props.updatePageLoad;\n    (async () => {\n      try {\n        loadHandler(true);\n        const response = await this.getTransactionDetail(data, query.order_id, updateHandler, loadHandler);\n        console.log(response);\n      } catch (err) {\n        console.log(err);\n      }\n    })().then(() => {\n      const res = this.registerPayment(this.props.states, updateHandler, loadHandler);\n      console.log(res);\n      console.log(this.props.states);\n    }).catch(function (error) {\n      updateHandler(\"form_status\", \"Koneksi bermasalah\");\n      updateHandler(\"is_valid\", false);\n      loadHandler(false);\n      console.log(error);\n    });\n  }\n\n  async getTransactionDetail(data, orderId, updateHandler, loadHandler) {\n    const url = \"https://cors-anywhere.herokuapp.com/https://api.sandbox.midtrans.com/v2/\" + orderId + \"/status\";\n    const config = {\n      auth: {\n        username: data.server_key,\n        password: \"\"\n      },\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: data.server_key + \":\"\n      }\n    };\n    const res = await axios.get(url, config).catch(function (error) {\n      updateHandler(\"form_status\", \"Koneksi bermasalah\");\n      updateHandler(\"is_valid\", false);\n      loadHandler(false);\n    });\n    const data_1 = res.data;\n    updateHandler(\"payment_desc\", data_1.payment_type);\n    updateHandler(\"bill_code\", orderId);\n    updateHandler(\"payment_ref_code\", data_1.transaction_id);\n    updateHandler(\"paid_amount\", data_1.gross_amount);\n    updateHandler(\"transaction_date\", moment(data_1.transaction_time).format(\"YYYY-MM-DD\"));\n    return data_1;\n  }\n\n  async registerPayment(states, updateHandler, loadHandler) {\n    const simedis = states.simedis;\n    const url = \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/payments\";\n    const data = {\n      paymentDesc: simedis.payment_desc,\n      paymentRefCode: simedis.bill_code,\n      billCode: simedis.bill_code,\n      amount: simedis.paid_amount,\n      paidAmount: simedis.paid_amount,\n      transactionDate: simedis.transaction_date,\n      paymentStatus: true,\n      usedReferralCode: \"\"\n    };\n    const res = await axios.post(url, data, \"\").catch(function (error) {\n      updateHandler(\"form_status\", \"Koneksi bermasalah\");\n      updateHandler(\"is_valid\", false);\n      loadHandler(false);\n      console.log(error);\n    });\n    loadHandler(false);\n    return res;\n  }\n\n  render() {\n    const {\n      states\n    } = this.props;\n    const text = \"Bagikan ke teman anda https://bit.ly/30t7Pn3\";\n\n    if (!states || states.is_loading === true) {\n      return /*#__PURE__*/React.createElement(Card, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Card.Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }\n      }, \"Loading\"), /*#__PURE__*/React.createElement(Card.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Loader, {\n        style: {\n          width: \"100%\",\n          height: \"100\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\"\n        },\n        type: \"ThreeDots\",\n        color: \"#2BAD60\",\n        height: \"100\",\n        width: \"100\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 13\n        }\n      })));\n    }\n\n    let content;\n\n    if (states.simedis.is_valid === false) {\n      content = /*#__PURE__*/React.createElement(Container, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        lg: 12,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Alerts, {\n        data: states.simedis,\n        valid: states.simedis.is_valid,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 15\n        }\n      }))));\n    } else {\n      content = /*#__PURE__*/React.createElement(Container, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        lg: 12,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }\n      }, \"Pembayaran Telah Selesai, Silahkan Cek Email Yang Anda Daftarkan Untuk Aktivasi Account\")), /*#__PURE__*/React.createElement(Row, {\n        className: \"mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        lg: 12,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        type: \"text\",\n        disabled: true,\n        defaultValue: text,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(CopyToClipboard, {\n        text: text,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        className: \"mt-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 17\n        }\n      }, \"Copy to Clipboard\")))));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Card.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 11\n      }\n    }, \"FINISH\"), /*#__PURE__*/React.createElement(Card.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Card.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 15\n      }\n    }, \"Pembayaran Selesai\"), /*#__PURE__*/React.createElement(Card.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 15\n      }\n    }, content)))));\n  }\n\n}\n\nexport default FinishedPayment;","map":{"version":3,"sources":["D:/project/app-apd/src/Pages/Finished/index.js"],"names":["React","Component","qs","axios","moment","Loader","Alerts","CopyToClipboard","Card","Button","Row","Container","Col","Form","FinishedPayment","copyCodeToClipboard","text","console","log","el","select","document","execCommand","componentDidMount","data","props","states","midtrans_account","updateHandler","simedisChange","query","parse","location","search","ignoreQueryPrefix","loadHandler","updatePageLoad","response","getTransactionDetail","order_id","err","then","res","registerPayment","catch","error","orderId","url","config","auth","username","server_key","password","headers","Accept","Authorization","get","data_1","payment_type","transaction_id","gross_amount","transaction_time","format","simedis","paymentDesc","payment_desc","paymentRefCode","bill_code","billCode","amount","paid_amount","paidAmount","transactionDate","transaction_date","paymentStatus","usedReferralCode","post","render","is_loading","width","height","display","justifyContent","alignItems","content","is_valid"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport qs from \"qs\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport Loader from \"react-loader-spinner\";\r\nimport Alerts from \"../../Components/Alerts\";\r\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\r\n\r\nimport { Card, Button, Row, Container, Col, Form } from \"react-bootstrap\";\r\n\r\nclass FinishedPayment extends Component {\r\n  componentDidMount() {\r\n    const data = this.props.states.midtrans_account;\r\n    const updateHandler = this.props.simedisChange;\r\n    //parsing URL\r\n    const query = qs.parse(this.props.location.search, {\r\n      ignoreQueryPrefix: true,\r\n    });\r\n    const loadHandler = this.props.updatePageLoad;\r\n\r\n    (async () => {\r\n      try {\r\n        loadHandler(true);\r\n        const response = await this.getTransactionDetail(\r\n          data,\r\n          query.order_id,\r\n          updateHandler,\r\n          loadHandler\r\n        );\r\n        console.log(response);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    })()\r\n      .then(() => {\r\n        const res = this.registerPayment(\r\n          this.props.states,\r\n          updateHandler,\r\n          loadHandler\r\n        );\r\n        console.log(res);\r\n        console.log(this.props.states);\r\n      })\r\n      .catch(function (error) {\r\n        updateHandler(\"form_status\", \"Koneksi bermasalah\");\r\n        updateHandler(\"is_valid\", false);\r\n        loadHandler(false);\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  copyCodeToClipboard = (text) => {\r\n    console.log(text);\r\n    const el = text;\r\n    el.select();\r\n    document.execCommand(\"copy\");\r\n  };\r\n\r\n  async getTransactionDetail(data, orderId, updateHandler, loadHandler) {\r\n    const url =\r\n      \"https://cors-anywhere.herokuapp.com/https://api.sandbox.midtrans.com/v2/\" +\r\n      orderId +\r\n      \"/status\";\r\n    const config = {\r\n      auth: {\r\n        username: data.server_key,\r\n        password: \"\",\r\n      },\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: data.server_key + \":\",\r\n      },\r\n    };\r\n\r\n    const res = await axios.get(url, config).catch(function (error) {\r\n      updateHandler(\"form_status\", \"Koneksi bermasalah\");\r\n      updateHandler(\"is_valid\", false);\r\n      loadHandler(false);\r\n    });\r\n    const data_1 = res.data;\r\n    updateHandler(\"payment_desc\", data_1.payment_type);\r\n    updateHandler(\"bill_code\", orderId);\r\n    updateHandler(\"payment_ref_code\", data_1.transaction_id);\r\n    updateHandler(\"paid_amount\", data_1.gross_amount);\r\n    updateHandler(\r\n      \"transaction_date\",\r\n      moment(data_1.transaction_time).format(\"YYYY-MM-DD\")\r\n    );\r\n    return data_1;\r\n  }\r\n\r\n  async registerPayment(states, updateHandler, loadHandler) {\r\n    const simedis = states.simedis;\r\n\r\n    const url =\r\n      \"https://cors-anywhere.herokuapp.com/https://sit-eli.myequity.id/payments\";\r\n\r\n    const data = {\r\n      paymentDesc: simedis.payment_desc,\r\n      paymentRefCode: simedis.bill_code,\r\n      billCode: simedis.bill_code,\r\n      amount: simedis.paid_amount,\r\n      paidAmount: simedis.paid_amount,\r\n      transactionDate: simedis.transaction_date,\r\n      paymentStatus: true,\r\n      usedReferralCode: \"\",\r\n    };\r\n\r\n    const res = await axios.post(url, data, \"\").catch(function (error) {\r\n      updateHandler(\"form_status\", \"Koneksi bermasalah\");\r\n      updateHandler(\"is_valid\", false);\r\n      loadHandler(false);\r\n      console.log(error);\r\n    });\r\n\r\n    loadHandler(false);\r\n\r\n    return res;\r\n  }\r\n\r\n  render() {\r\n    const { states } = this.props;\r\n    const text = \"Bagikan ke teman anda https://bit.ly/30t7Pn3\";\r\n    if (!states || states.is_loading === true) {\r\n      return (\r\n        <Card>\r\n          <Card.Header>Loading</Card.Header>\r\n          <Card.Body>\r\n            <Loader\r\n              style={{\r\n                width: \"100%\",\r\n                height: \"100\",\r\n                display: \"flex\",\r\n                justifyContent: \"center\",\r\n                alignItems: \"center\",\r\n              }}\r\n              type=\"ThreeDots\"\r\n              color=\"#2BAD60\"\r\n              height=\"100\"\r\n              width=\"100\"\r\n            />\r\n          </Card.Body>\r\n        </Card>\r\n      );\r\n    }\r\n\r\n    let content;\r\n\r\n    if (states.simedis.is_valid === false) {\r\n      content = (\r\n        <Container>\r\n          <Row>\r\n            <Col lg={12} className=\"text-center\">\r\n              <Alerts data={states.simedis} valid={states.simedis.is_valid} />\r\n            </Col>\r\n          </Row>\r\n        </Container>\r\n      );\r\n    } else {\r\n      content = (\r\n        <Container>\r\n          <Row>\r\n            <Col lg={12} className=\"text-center\">\r\n              Pembayaran Telah Selesai, Silahkan Cek Email Yang Anda Daftarkan\r\n              Untuk Aktivasi Account\r\n            </Col>\r\n          </Row>\r\n          <Row className=\"mt-2\">\r\n            <Col lg={12} className=\"text-center\">\r\n              {/* <a\r\n                className=\"btn btn-primary mb-4\"\r\n                download={`certificate_${states.simedis.bill_code}.pdf`}\r\n                href={states.simedis.base64}\r\n              >\r\n                Download Certificate\r\n              </a> */}\r\n              <Form.Control\r\n                type=\"text\"\r\n                disabled={true}\r\n                defaultValue={text}\r\n                className=\"text-center\"\r\n              />\r\n\r\n              <CopyToClipboard text={text}>\r\n                <Button className=\"mt-4\">Copy to Clipboard</Button>\r\n              </CopyToClipboard>\r\n            </Col>\r\n          </Row>\r\n        </Container>\r\n      );\r\n    }\r\n    return (\r\n      <div>\r\n        <Card>\r\n          <Card.Header>FINISH</Card.Header>\r\n          <Card.Body>\r\n            <Card>\r\n              <Card.Header>Pembayaran Selesai</Card.Header>\r\n              <Card.Body>{content}</Card.Body>\r\n            </Card>\r\n          </Card.Body>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FinishedPayment;\r\n"]},"metadata":{},"sourceType":"module"}